

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Cloud data overview &mdash; Pangeo CMIP6  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/favicon.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Accessing data in the cloud" href="accessing_data.html" />
    <link rel="prev" title="Pangeo CMIP6" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #5EB130" >
          

          
            <a href="index.html" class="icon icon-home"> Pangeo CMIP6
          

          
            
            <img src="_static/small_e_logo_cropped.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Cloud data overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#zarr-storage-format">Zarr storage format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#directory-structure">Directory structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#csv-file-structure">CSV file structure</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="accessing_data.html">Accessing data in the cloud</a><ul>
<li class="toctree-l2"><a class="reference internal" href="accessing_data.html#opening-a-single-zarr-data-store">Opening a single Zarr data store</a></li>
<li class="toctree-l2"><a class="reference internal" href="accessing_data.html#manually-searching-the-catalog">Manually searching the catalog</a></li>
<li class="toctree-l2"><a class="reference internal" href="accessing_data.html#loading-an-esm-collection">Loading an ESM collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="accessing_data.html#searching-for-datasets">Searching for datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="accessing_data.html#loading-datasets">Loading datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="accessing_data.html#preprocessing-the-cmip6-datasets">Preprocessing the CMIP6 datasets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pangeo_catalog.html">Pangeo Catalog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pangeo_catalog.html#accessing-catalogs-using-python">Accessing catalogs using Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="pangeo_catalog.html#accessing-catalogs-using-catalog-pangeo-io">Accessing catalogs using catalog.pangeo.io</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pangeo CMIP6</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Cloud data overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/overview.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cloud-data-overview">
<h1>Cloud data overview<a class="headerlink" href="#cloud-data-overview" title="Permalink to this headline">¶</a></h1>
<p>CMIP6 data in the cloud can be found in both Google Cloud and S3 storage buckets:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gs://cmip6</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s3://cmip6-pds</span></code></p></li>
</ul>
<p>The data is primarily <a class="reference external" href="https://zarr.readthedocs.io/en/stable/">Zarr</a>-formatted, with a predetermined and well-defined directory structure to ensure that it is properly organized and classified.
This directory structure is reflected in the master CSV files located at the root of each bucket, which enumerates all available Zarr stores using their containing directory names as columns to allow for sorting and filtering.</p>
<div class="section" id="zarr-storage-format">
<h2>Zarr storage format<a class="headerlink" href="#zarr-storage-format" title="Permalink to this headline">¶</a></h2>
<p>Each data store in the CMIP6 collection consists of all of the data, including the grids and metadata, stored in Zarr format.
This format stores the data as a collection of files consisting of regular text files containing metadata and data files consisting of the data divided into compressed chunks which can be read individually or in parallel, allowing very large datasets to scale more efficiently in the cloud.</p>
<p>The original datasets, stored in the WCRP/CMIP6 ESGF repositories, consist of <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/">netCDF</a> files.
Each of these datasets typically corresponds to a single variable saved at specified time intervals for the length of a single model run.
For convenience, these datasets were often divided into multiple netCDF files.
Our Zarr data stores correspond to the result of concatenating these netCDF files and then storing them as a single Zarr object.
All of the metadata in the original netCDF files has been preserved, including the licensing information and the CMIP6 persistent identifiers (<code class="docutils literal notranslate"><span class="pre">tracking_ids</span></code>) which are unique for each of the original netCDF files.</p>
<p>A Zarr data store <code class="docutils literal notranslate"><span class="pre">tracking_id</span></code> consists of a concatenated list of the netCDF <code class="docutils literal notranslate"><span class="pre">tracking_ids</span></code> from which it was created. An individual <code class="docutils literal notranslate"><span class="pre">tracking_id</span></code> can be looked up at <a class="reference external" href="http://hdl.handle.net/">Handle.net</a>  (e.g., enter “<a class="reference external" href="hdl:21.14100/33cbdc29-fbc9-44ab-9e09-5dc7824441cf">hdl:21.14100/33cbdc29-fbc9-44ab-9e09-5dc7824441cf</a>”, which then redirects <a class="reference external" href="https://handle-esgf.dkrz.de/lp/21.14100/33cbdc29-fbc9-44ab-9e09-5dc7824441cf/">here</a>).</p>
</div>
<div class="section" id="directory-structure">
<h2>Directory structure<a class="headerlink" href="#directory-structure" title="Permalink to this headline">¶</a></h2>
<p><strong>UPDATE: Feb. 1, 2021:</strong> Please note that our zarr store names, and therefore the URLs for our zarr stores,  has recently changed. For example, the prefix is now <code class="docutils literal notranslate"><span class="pre">gs://cmip6/CMIP6/</span></code> on GC and <code class="docutils literal notranslate"><span class="pre">s3://cmip6-pds/CMIP6/</span></code> on AWS S3. In addition, conforming to the ESGF syntax, we have appended the <code class="docutils literal notranslate"><span class="pre">version_id</span></code> (e.g., /v20200101) to the names.</p>
<p>To organize the data there is a list of keywords, each with a <a class="reference external" href="https://github.com/WCRP-CMIP/CMIP6_CVs">controlled vocabulary</a> which has been developed over the many CMIP iterations.
The keywords categorize the model data in the many ways we might want to search the data.
For example, to find all available 3-hourly precipitation data from the pre-industrial control runs, we only need to specify the variable, frequency and experiment name.
In this case, the keywords <code class="docutils literal notranslate"><span class="pre">['variable_id',</span> <span class="pre">'table_id',</span> <span class="pre">'experiment_id']</span></code> will have the values <code class="docutils literal notranslate"><span class="pre">['pr',</span> <span class="pre">'3hr',</span> <span class="pre">'piControl']</span></code>.
The data are now structured in this cloud repository using 9 of these keywords in this order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cmip6[-pds]/CMIP6/
└──&lt;activity_id&gt;/
    └──&lt;institution_id&gt;/
        └──&lt;source_id&gt;/
            └──&lt;experiment_id&gt;/
                └──&lt;member_id&gt;/
                    └──&lt;table_id&gt;/
                        └──&lt;variable_id&gt;/
                            └──&lt;grid_label&gt;/
                                └──&lt;version_id&gt;/
</pre></div>
</div>
<p>Each object specified in this way refers to a single Zarr data store.</p>
</div>
<div class="section" id="csv-file-structure">
<h2>CSV file structure<a class="headerlink" href="#csv-file-structure" title="Permalink to this headline">¶</a></h2>
<p>We maintain CSV files listing the most recent versions of the Zarr data stores, providing the keyword values in columns as well as the dataset URLs and some additional information.  These files allow for rapid searching by keyword using your favorite spreadsheet software.  For example, in python, we generally use the <cite>pandas</cite> package.</p>
<p>There are two different master CSV files located at the root of the GCS bucket; one contains only datasets with no serious issues listed in the official <a class="reference external" href="https://errata.es-doc.org/static/index.html">ESGF Errata Service</a>:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://storage.googleapis.com/cmip6/pangeo-cmip6.csv">https://storage.googleapis.com/cmip6/pangeo-cmip6.csv</a></p></li>
</ul>
<p>And the other contains all available Zarr data stores, including those with serious issues (represented with a <code class="docutils literal notranslate"><span class="pre">-noQC</span></code> label):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://storage.googleapis.com/cmip6/pangeo-cmip6-noQC.csv">https://storage.googleapis.com/cmip6/pangeo-cmip6-noQC.csv</a></p></li>
</ul>
<p>For now, in the AWS bucket, we currently only have one master CSV file, which contains ALL of the Zarr stores regardless of ESGF issues:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cmip6-pds.s3-us-west-2.amazonaws.com/pangeo-cmip6.csv">https://cmip6-pds.s3-us-west-2.amazonaws.com/pangeo-cmip6.csv</a></p></li>
</ul>
<p>For backward compatibility on GCS, we also maintain redundant copies called “cmip6-zarr-consolidated-stores.csv” and “cmip6-zarr-consolidated-stores-noQC.csv”.</p>
<p>The first 8 column names correspond to the standard CMIP keywords; the next three additional columns are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">zstore</span></code>: URL of the corresponding Zarr data store</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dcpp_init_year</span></code>: optional metadata for convenience when accessing <a class="reference external" href="https://www.wcrp-climate.org/dcp-overview">DCPP</a>-type experiments</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">version</span></code>: approximate data of model output file as listed on ESGF in YYYYMMDD format</p></li>
</ul>
<p>Finally, the <code class="docutils literal notranslate"><span class="pre">-noQC</span></code> variants exclusively include three additional columns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code>: status of the dataset’s issue, if any, using a controlled vocabulary:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">new</span></code>: issue has been recently raised with no other updates to status</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">onhold</span></code>: issue is in the process of being examined or resolved</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resolved</span></code>: issue has been resolved AND the corrected files have been published on ESGF with a new dataset version</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wontfix</span></code>: issue cannot/won’t be fixed by the data provider; may result in a persistent low severity issue with no consequences to analysis</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">severity</span></code>: severity of the dataset’s issue, if any, using a controlled vocabulary:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">low</span></code>: issue concerns file management (e.g., addition, removal, period extension, etc.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">medium</span></code>: issue concerns metadata (netCDF attributes) without undermining the values of the involved variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">high</span></code>: issue concerns single point variable or axis values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">critical</span></code>: issue concerns the variable or axis values undermining the analysis; use of this data is strongly discouraged</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">issue_url</span></code>: link to view the issue on ESGF Errata Service</p></li>
</ul>
<p>There are currently over 400,000 entries - which is too large for Google Spreadsheets, but can be viewed in most standard spreadsheet applications and the entries can be sorted, selected and discovered quickly and efficiently.  We find that importing them as a python <code class="docutils literal notranslate"><span class="pre">pandas</span></code> dataframe is very useful.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="accessing_data.html" class="btn btn-neutral float-right" title="Accessing data in the cloud" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Pangeo CMIP6" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019-2021, Pangeo Community.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>